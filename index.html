<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>CHECK VIP</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

</head>

<body>

<div id="loginScreen" style="
position:fixed;
top:0;
left:0;
width:100%;
height:100%;
background:#000;
display:flex;
justify-content:center;
align-items:center;
z-index:9999;
">
  <div style="width:360px;background:#111;padding:30px;border-radius:20px;border:1px solid gold;">
    <h2 style="text-align:center;color:gold;">ğŸ” Tool Ve Chai Admin</h2>
    <input id="loginEmail" type="email" placeholder="Nháº­p Gmail"
    style="margin-top:15px;width:100%;padding:12px;border-radius:10px;border:none;background:#222;color:white;">
    <input id="loginPass" type="password" placeholder="Nháº­p Password"
    style="margin-top:10px;width:100%;padding:12px;border-radius:10px;border:none;background:#222;color:white;">
    <button onclick="secureLogin()" 
    style="margin-top:15px;width:100%;padding:12px;border-radius:10px;background:gold;font-weight:bold;">
      LOGIN
    </button>
    <div id="loginError" style="color:red;text-align:center;margin-top:10px;"></div>
  </div>
</div>

<div style="padding:20px;max-width:900px;margin:auto;">
  <h2>ğŸ›  Tool Ve Chai Check VIP</h2>

  <input id="q" placeholder="Nháº­p mÃ£ cáº§n kiá»ƒm tra"
    style="width:100%;padding:12px;border-radius:10px;margin-top:10px;">
  <button onclick="check()"
    style="width:100%;padding:12px;border-radius:10px;margin-top:10px;">
    CHECK
  </button>

  <div id="out" style="margin-top:20px;"></div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCEL7BDXvmNi2dp1VNpua7b2plpTiTOK3U",
  authDomain: "toolvechai.firebaseapp.com",
  projectId: "toolvechai"
};

firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db = firebase.firestore();

auth.setPersistence(firebase.auth.Auth.Persistence.NONE);

// LOGIN
function secureLogin(){
  const email = document.getElementById("loginEmail").value;
  const pass = document.getElementById("loginPass").value;

  auth.signInWithEmailAndPassword(email, pass)
    .then(() => {
      document.getElementById("loginScreen").remove();
    })
    .catch(() => {
      document.getElementById("loginError").innerText = "Sai Gmail hoáº·c Password!";
    });
}

// Náº¿u Ä‘Ã£ login thÃ¬ tá»± bá» mÃ n hÃ¬nh login
auth.onAuthStateChanged(function(user){
  if(user){
    document.getElementById("loginScreen").remove();
  }
});

// MAP MMC
const mmcMap={
 MMC1:"16G",MMC2:"32G",MMC3:"64G",
 MMC4:"128G",MMC5:"256G",MMC6:"512G"
};

// DETECT CHIP
function detectChip(code){
  code = code.toUpperCase();

  if(code.startsWith("KM") || code.startsWith("KLM") || code.startsWith("KLU") ||
     code.startsWith("KMB") || code.startsWith("KM8") || code.startsWith("KMF") ||
     code.startsWith("KMQ") || code.startsWith("KMR") || code.startsWith("KMD") ||
     code.startsWith("KMG")){
    return { name:"SAMSUNG", icon:"ğŸŸ¢" };
  }

  if(code.startsWith("H9") || code.startsWith("H26") || code.startsWith("H28") ||
     code.startsWith("H2") || code.startsWith("HN") || code.startsWith("H5")){
    return { name:"SK hynix", icon:"ğŸŸ£" };
  }

  if(code.startsWith("JZ") || code.startsWith("MT")){
    return { name:"MICRON", icon:"ğŸ”µ" };
  }

  if(code.startsWith("THG")){
    return { name:"KIOXIA / TOSHIBA", icon:"ğŸŸ " };
  }

  if(code.startsWith("SDIN") || code.startsWith("SD") || code.startsWith("WDC")){
    return { name:"SANDISK / WD", icon:"ğŸ”´" };
  }

  return { name:"UNKNOWN / OEM", icon:"âšª" };
}

// CHECK CODE FROM FIRESTORE
async function check(){

  const input = document.getElementById("q").value.trim();
  const out = document.getElementById("out");
  out.innerHTML = "";

  if(!input) return;

  try {

    const doc = await db.collection("codes").doc(input).get();

    if(!doc.exists){
      out.innerHTML = "âŒ KhÃ´ng xÃ¡c Ä‘á»‹nh mÃ£";
      return;
    }

    const data = doc.data();
    const chip = detectChip(input);
    const size = mmcMap[data.mmc] || "";

    out.innerHTML = `
      <div>
        <b>âš¡ ${input}</b><br>
        ${chip.icon} ${chip.name}<br>
        ${data.mmc ? "ğŸ’¾ "+data.mmc+" ("+size+")<br>" : ""}
        ${data.vip ? "ğŸ‘‘ "+data.vip : ""}
      </div>
    `;

  } catch(e){
    out.innerHTML = "âŒ ChÆ°a Ä‘Äƒng nháº­p hoáº·c khÃ´ng cÃ³ quyá»n truy cáº­p";
  }
}
</script>

</body>
</html>
